<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>Snpenrichment by mcanouil</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>Snpenrichment</h1>
        <h2>Implements classes and methods for large scale SNP enrichment analysis (e.g. SNPs associated with genes expression in a GWAS signal)</h2>
        <a href="https://github.com/mcanouil/snpEnrichment" class="button"><small>View project on</small> GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <p><a href="https://travis-ci.org/mcanouil/snpEnrichment"><img src="https://travis-ci.org/mcanouil/snpEnrichment.svg?branch=master" alt="Build Status"></a></p>

<h1>
<a id="note" class="anchor" href="#note" aria-hidden="true"><span class="octicon octicon-link"></span></a>Note</h1>

<p>Internal data management in 'snpEnrichment' use RefSNP (rs) IDs.</p>

<h1>
<a id="example" class="anchor" href="#example" aria-hidden="true"><span class="octicon octicon-link"></span></a>Example</h1>

<h2>
<a id="1-install-and-load-snpenrichment" class="anchor" href="#1-install-and-load-snpenrichment" aria-hidden="true"><span class="octicon octicon-link"></span></a>1. Install and load snpEnrichment</h2>

<p>To install the stable version from CRAN, simply run the following from an R console:</p>

<div class="highlight highlight-r"><pre>install.packages(<span class="pl-s"><span class="pl-pds">"</span>snpEnrichment<span class="pl-pds">"</span></span>)</pre></div>

<p>To install the latest development builds directly from GitHub, run this instead:</p>

<div class="highlight highlight-r"><pre><span class="pl-k">if</span> (<span class="pl-k">!</span>require(<span class="pl-s"><span class="pl-pds">"</span>devtools<span class="pl-pds">"</span></span>)) { install.packages(<span class="pl-s"><span class="pl-pds">"</span>devtools<span class="pl-pds">"</span></span>) } <span class="pl-k">else</span> {}
<span class="pl-e">devtools</span><span class="pl-k">::</span>install_github(<span class="pl-s"><span class="pl-pds">"</span>mcanouil/snpEnrichment<span class="pl-pds">"</span></span>)</pre></div>

<p>Load <em>snpEnrichment</em>:</p>

<div class="highlight highlight-r"><pre>library(<span class="pl-smi">snpEnrichment</span>)</pre></div>

<h2>
<a id="2-prepare-data" class="anchor" href="#2-prepare-data" aria-hidden="true"><span class="octicon octicon-link"></span></a>2. Prepare data</h2>

<div class="highlight highlight-r"><pre><span class="pl-smi">snpInfoDir</span> <span class="pl-k">&lt;-</span> system.file(<span class="pl-s"><span class="pl-pds">"</span>extdata/snpInfo<span class="pl-pds">"</span></span>, <span class="pl-v">package</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>snpEnrichment<span class="pl-pds">"</span></span>)
<span class="pl-smi">signalFile</span> <span class="pl-k">&lt;-</span> system.file(<span class="pl-s"><span class="pl-pds">"</span>extdata/Signal/toySignal.txt<span class="pl-pds">"</span></span>, <span class="pl-v">package</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>snpEnrichment<span class="pl-pds">"</span></span>)

initFiles(<span class="pl-v">pattern</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>Chrom<span class="pl-pds">"</span></span>, <span class="pl-smi">snpInfoDir</span>, <span class="pl-smi">signalFile</span>, <span class="pl-v">mc.cores</span> <span class="pl-k">=</span> <span class="pl-c1">1</span>)

writeLD(<span class="pl-v">pattern</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>Chrom<span class="pl-pds">"</span></span>, <span class="pl-smi">snpInfoDir</span>, <span class="pl-smi">signalFile</span>, <span class="pl-v">ldDir</span> <span class="pl-k">=</span> <span class="pl-c1">NULL</span>,
        <span class="pl-v">ldThresh</span> <span class="pl-k">=</span> <span class="pl-c1">0.8</span>, <span class="pl-v">depth</span> <span class="pl-k">=</span> <span class="pl-c1">1000</span>, <span class="pl-v">mc.cores</span> <span class="pl-k">=</span> <span class="pl-c1">1</span>)</pre></div>

<h2>
<a id="3-read-data" class="anchor" href="#3-read-data" aria-hidden="true"><span class="octicon octicon-link"></span></a>3. Read data</h2>

<div class="highlight highlight-r"><pre><span class="pl-smi">snpListDir</span> <span class="pl-k">&lt;-</span> system.file(<span class="pl-s"><span class="pl-pds">"</span>extdata/List<span class="pl-pds">"</span></span>, <span class="pl-v">package</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>snpEnrichment<span class="pl-pds">"</span></span>)
data(<span class="pl-smi">transcript</span>)
<span class="pl-smi">transcriptFile</span> <span class="pl-k">&lt;-</span> <span class="pl-smi">transcript</span>

<span class="pl-smi">toyData</span> <span class="pl-k">&lt;-</span> readEnrichment(
    <span class="pl-v">pattern</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>Chrom<span class="pl-pds">"</span></span>, <span class="pl-smi">signalFile</span>, <span class="pl-smi">transcriptFile</span>, <span class="pl-smi">snpListDir</span>, <span class="pl-smi">snpInfoDir</span>,
    <span class="pl-v">distThresh</span> <span class="pl-k">=</span> <span class="pl-c1">1000</span>, <span class="pl-v">sigThresh</span> <span class="pl-k">=</span> <span class="pl-c1">0.05</span>, <span class="pl-v">LD</span> <span class="pl-k">=</span> <span class="pl-c1">TRUE</span>, <span class="pl-v">ldDir</span> <span class="pl-k">=</span> <span class="pl-c1">NULL</span>,
    <span class="pl-v">mc.cores</span> <span class="pl-k">=</span> <span class="pl-c1">1</span>
)
<span class="pl-smi">toyData</span></pre></div>

<h2>
<a id="4-compute-results" class="anchor" href="#4-compute-results" aria-hidden="true"><span class="octicon octicon-link"></span></a>4. Compute results</h2>

<div class="highlight highlight-r"><pre>reSample(<span class="pl-v">object</span> <span class="pl-k">=</span> <span class="pl-smi">toyData</span>,
         <span class="pl-v">nSample</span> <span class="pl-k">=</span> <span class="pl-c1">10</span>,
         <span class="pl-v">empiricPvalue</span> <span class="pl-k">=</span> <span class="pl-c1">TRUE</span>,
         <span class="pl-v">MAFpool</span> <span class="pl-k">=</span> c(<span class="pl-c1">0.05</span>, <span class="pl-c1">0.10</span>, <span class="pl-c1">0.2</span>, <span class="pl-c1">0.3</span>, <span class="pl-c1">0.4</span>, <span class="pl-c1">0.5</span>),
         <span class="pl-v">mc.cores</span> <span class="pl-k">=</span> <span class="pl-c1">1</span>,
         <span class="pl-v">onlyGenome</span> <span class="pl-k">=</span> <span class="pl-c1">TRUE</span>)</pre></div>

<h2>
<a id="5-further-analysis-exclude-snp-from-original-list" class="anchor" href="#5-further-analysis-exclude-snp-from-original-list" aria-hidden="true"><span class="octicon octicon-link"></span></a>5. Further analysis: Exclude SNP from original list.</h2>

<div class="highlight highlight-r"><pre><span class="pl-smi">excludeFile</span> <span class="pl-k">&lt;-</span> c(
    <span class="pl-s"><span class="pl-pds">"</span>rs4376885<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>rs17690928<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>rs6460708<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>rs13061537<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>rs11769827<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>rs12717054<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>rs2907627<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>rs1380109<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>rs7024214<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>rs7711972<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>rs9658282<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>rs11750720<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>rs1793268<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>rs774568<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>rs6921786<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>rs1699031<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>rs6994771<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>rs16926670<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>rs465612<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>rs3012084<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>rs354850<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>rs12803455<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>rs13384873<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>rs4364668<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>rs8181047<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>rs2179993<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>rs12049335<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>rs6079926<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>rs2175144<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>rs11564427<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>rs7786389<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>rs7005565<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>rs17423335<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>rs12474102<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>rs191314<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>rs10513168<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>rs1711437<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>rs1992620<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>rs283115<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>rs10754563<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>rs10851727<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>rs2173191<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>rs7661353<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>rs1342113<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>rs7042073<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>rs1567445<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>rs10120375<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>rs550060<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>rs3761218<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>rs4512977<span class="pl-pds">"</span></span>
)</pre></div>

<p>OR</p>

<div class="highlight highlight-r"><pre><span class="pl-smi">excludeFile</span> <span class="pl-k">&lt;-</span> system.file(<span class="pl-s"><span class="pl-pds">"</span>extdata/Exclude/toyExclude.txt<span class="pl-pds">"</span></span>, <span class="pl-v">package</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>snpEnrichment<span class="pl-pds">"</span></span>)</pre></div>

<div class="highlight highlight-r"><pre><span class="pl-smi">toyData_exclude</span> <span class="pl-k">&lt;-</span> excludeSNP(<span class="pl-smi">toyData</span>, <span class="pl-smi">excludeFile</span>, <span class="pl-v">mc.cores</span> <span class="pl-k">=</span> <span class="pl-c1">1</span>)</pre></div>

<p><strong>Warning:</strong> <em>compareEnrichment is in development!!</em></p>

<div class="highlight highlight-r"><pre><span class="pl-smi">compareResults</span> <span class="pl-k">&lt;-</span> compareEnrichment(<span class="pl-v">object.x</span> <span class="pl-k">=</span> <span class="pl-smi">toyData</span>,
                                    <span class="pl-v">object.y</span> <span class="pl-k">=</span> <span class="pl-smi">toyData_exclude</span>,
                                    <span class="pl-v">pattern</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>Chrom<span class="pl-pds">"</span></span>,
                                    <span class="pl-v">nSample</span> <span class="pl-k">=</span> <span class="pl-c1">10</span>,
                                    <span class="pl-v">empiricPvalue</span> <span class="pl-k">=</span> <span class="pl-c1">TRUE</span>,
                                    <span class="pl-v">mc.cores</span> <span class="pl-k">=</span> <span class="pl-c1">1</span>,
                                    <span class="pl-v">onlyGenome</span> <span class="pl-k">=</span> <span class="pl-c1">TRUE</span>)</pre></div>

<h2>
<a id="6-watch-results" class="anchor" href="#6-watch-results" aria-hidden="true"><span class="octicon octicon-link"></span></a>6. Watch results</h2>

<div class="highlight highlight-r"><pre>show(<span class="pl-smi">toyData</span>)
print(<span class="pl-smi">toyData</span>)
head(getEnrichSNP(<span class="pl-smi">toyData</span>, <span class="pl-v">type</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>xSNP<span class="pl-pds">"</span></span>))

show(<span class="pl-smi">toyData_exclude</span>)
print(<span class="pl-smi">toyData_exclude</span>)
head(getEnrichSNP(<span class="pl-smi">toyData_exclude</span>, <span class="pl-v">type</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>eSNP<span class="pl-pds">"</span></span>))</pre></div>
        </section>

        <aside id="sidebar">
          <a href="https://github.com/mcanouil/snpEnrichment/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/mcanouil/snpEnrichment/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/mcanouil/snpEnrichment"></a> is maintained by <a href="https://github.com/mcanouil">mcanouil</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

  
  </body>
</html>
